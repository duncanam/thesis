\chapter{Introduction}
\label{introchap}


\section{Motivation}
Many challenges associated with modern combustion systems, such as improving the efficiency and performance of internal combustion engines, have been the focus of considerable research for the past several decades. This focus has resulted in improved engine performance, efficiency, and reliability. However, internal combustion engines are just one area within the much broader field of study of reacting flows, which can include topics as diverse as wildfires, supernovae, explosions, ocean biogeochemistry, and aircraft or rocket propulsion.

Considering aircraft and rocket propulsion, in particular, modeling of these systems is made exceedingly difficult by the reactive and potentially high-Mach nature of the turbulent flows involved in these applications. Computational fluid dynamics (CFD) is often used to model these flows, where the system domain is discretized using a computational grid, on which flow equations such as the Navier-Stokes equations are solved. Alternative to CFD is modeling the fluid particles themselves discretely, like what is done with some gas dynamics simulations. For reacting flows and other standard fluid problems, this is prohibitively expensive or impossible to model computationally, as there are billions of particles to track, as well as their interactions. Instead, the fluid can be modeled using continuum mechanics, where the behavior of the fluid is modeled as a continuous volume. This greatly simplifies how many computations must be performed. For CFD that utilizes continuum mechanics of high-speed turbulent reacting flows, this grid must be very fine in order to maintain accurate solutions of the governing equations. The addition of chemical reactions further complicates the calculation and can substantially increase the time required for a solution. As a result, CFD of high-speed turbulent reacting flows is computationally expensive and the use of cost-reducing methods, such as subgrid-scale modeling for large eddy simulations (LES), can substantially reduce physical accuracy.  

These challenges are all particularly relevant to a growing area of interest within aircraft and rocket propulsion; namely, the use of detonation engines to achieve high efficiency and high speed propulsion. Two main subtypes of these engines exist: the pulsed detonation engine (PDE) and the rotating detonation engine (RDE). Both PDEs and RDEs are attractive since, in principle, they can theoretically produce higher efficiencies than traditional propulsive devices such as turbofans and some rocket engines. Both of these propulsion technologies rely on the ignition of a detonation wave (i.e., a supersonic flame front) to provide the means of propulsion. The detonation wave itself is usually quite thin and is accompanied by high pressures and temperatures. 

With such fast and physically small flow features, detonations require very fine grids in order to be accurately captured. This adds to the computational expense of turbulent reacting flow simulations relevant to PDEs and RDEs. A potential solution to this problem is to adaptively refine the grid (mesh), allowing for a finer meshes in locations where high resolutions are more critical, such as around a detonation wave, and a less refined mesh in areas of the domain that do not have complex flow features. By doing this, the computer is only solving the fluid equations on grid points where necessary, so computational resources are deployed as efficiently as possible. The resulting procedure is called adaptive mesh refinement (AMR). 

Because PDEs and RDEs have strong detonation waves within their domains, they are ideal candidates for the efficiency and performance gains enabled by AMR. With AMR, PDE and RDE computational research can progress more efficiently, since accurate flow-field solutions can be obtained with less computational expense. The present MS thesis is focused, in particular, on developing an AMR capability for the simulation of detonation waves found in PDEs and RDEs.

\section{Objectives and Scope}
The primary objective of this thesis is to implement and test AMR techniques for simulations of detonation waves found in PDEs and RDEs using the open-source computational fluid dynamics toolbox known as OpenFOAM \cite{weller}. Compared to an in-house CFD code use previously for detonation engine research \cite{towery1}, OpenFOAM has several benefits, including increased geometric flexibility, an input structure that is nearly identical for most solvers, reduced modeling time when comparing solvers for similar cases, and documentation is more widely-available.

The cases studied in this thesis demonstrate the shock-capturing accuracy of the solver, as well as the simulation of one- and two-dimensional detonations. Three-dimensional detonations with AMR were tested, but are not the primary focus and presented higher computational cost for studying AMR parameters. Another objective of this thesis work is to build on previous work \cite{towery1} and develop the detonation modeling techniques with AMR in OpenFOAM such that the Turbulence and Energy Systems Laboratory (TESLa) at the University of Colorado, Boulder can use them for more in-depth and important research, such as the optimization of geometrically-complex RDE systems. As such, the focus of this thesis is centered on solver methods, exploration of solver features, AMR configuration sensitivites, and building a framework that can serve as the basis for further research. 

\section{Relevant Previous Work}
In order to be able to do the research outlined in this document, many resources were utilized and many others have layed the path in which this work was built on. 

The primary work this research was built on was done by Towery \textit{et al.} \cite{towery1}. The work done in this paper examined both PDE or detonation tube computational modeling as well as RDE modeling. The numerical code used was developed in-house by TESLa, written in Fortran and was massively scalable in parallel. However, this code lacked the geometric and generic flexibility of OpenFOAM, hence the research done in this document. This paper examined numerical methods for large eddy simulation (LES) of PDEs and RDEs in two and three dimensions. Reynolds averaged turbulence models were also compared to the higher resolution LES simulation results. This research simulated the reactive Euler equations, and the flow fields were thus inviscid. Both single and two-step reactions kinetics were used in the simulation of detonations in comparison to the single step kinetics used in this document. AMR was not utilized for simulation. 

In 2013 Schwer and Kailasanath \cite{schwer1} examined the effects of different hydrocarbon fuels on RDEs as well as as their numerical methods for simulating RDEs and detonation waves in tubes. Their tube detonation simulations were performed using a flux-corrrected-transport (FCT) algorithm scaled across hundreds of cores in parallel. Their work showed that RDEs are not affected by thermodynamic differences in hydrocarbon fuels in comparison to hydrogen fuel and that ideal detonation cycle theory could be used for baseline performance. In order to reach conclusions about RDE performance, studies were done on PDE and detonation tube modeling to verify the validity of their solution methods, much like the work done in this document. Detonation tube numerical results were compared to Chapman\cite{chapman}-Jouguet\cite{jouguet} (CJ) theory  and detonation cellular structure was also produced. 

Marcantoni \textit{et al.} \cite{marcantoni} created \verb|rhoCentralRfFoam|, a non-AMR solver, by combining Kurganov central schemes that model compressible flow from \verb|rhoCentralFoam| \cite{greenshields} with reaction modeling capability. Various mass fraction compositions were tested in air as well as chemistry validity spanning into multi-reaction chemical models. They selected a maximum Courant number of 0.25 for the one-dimensional planar detonation tests. \verb|rhoCentralRfFoam| was found to agree with CJ theory as well as other numerical codes such as CEA \cite{CEA}. 

Dinh \textit{et al.} \cite{dinh} developed an in-house proprietary OpenFOAM code for modeling detonations. This code had the ability to use AMR and was run on a single processor. The AMR parameters used for tracking refinement were normalized reaction heat as well as normalized velocity gradient at an interval of every 10 computational time steps. Together, both thresholds had to be met in order for AMR to occur. Comparisons with analytical theory such as CJ theory or experimental results were not performed in this work, and research done was more exploratory to determine the applicability of the solver. 

Additionally in 2019, Kim and Kim \cite{kim} used an OpenFOAM solver with central-upwind schemes to study hydrogen-air detonation within confined spaces. Arrhenius rate modeling with seven-step chemistry component reactions were utilized. Similar numerical schemes for solving the inviscid reactive Euler equations were used in this work compared to the solvers in this document. Shock tube comparison was done for solver validation as well as further comparison to confined detonation cases, and a CFL number of 0.1 was prescribed. It was found that their solver was capable of capturing shock structures and fluid modeling to match theory as well being able to replicate accurate confined hydrogen-air detonations. 

Li \textit{et al.} \cite{li} used AMR with the parallelized AMROC code to simulate cellular detonation diffraction. Cellular detonation structure diffracting can be seen when emerging from a confined space into a larger one. The inviscid Euler equations with two-step Arrhenius rate chemistry were modeled. They were successful in simulating detonation cells that were comparable to experimental results. The AMR used in the simulations was fine enough to resolve fine detonation structure, and adaptively refined the mesh into smaller half-squares using the Berger-Oliger AMR algorithm \cite{berger1984}. 

In 1985, Berger and Jameson \cite{berger1985} used an AMR method in the transonic domain while solving the steady Euler equations. In this paper, more refined and less refined cell interfaces are examined as well as the boundary conditions between refined and unrefined regions. Unlike specific parameter-tracking AMR such as the methods used in this thesis, the method utilized in this paper involved time stepping forward across the grid and then considering each grid point for large residual error. Grid points with more error were refined further. 

Then, in 1989, Berger and Colella  \cite{berger1989} used the adaptive meshing routines shown in 1985 to simulate shock hydrodynamics. The AMR is automatic and centered around the solving of two-dimensional hyperbolic conservation laws. These routines consisted of 3000 lines of Fortran. This paper also focused on minimizing CPU and memory overhead of the adaptive meshing, something that was noticed in this thesis to be non-negligible. 

Subsequently, Deiterding  \cite{deiterding} took the AMR routines from Berger and Colella to simulate multi-dimensional detonation structures. The simulations modeled detonations with the inviscid Euler equations, with recursively-iterated adaptive meshing. Parallelization and distributed computing is developed and implemented. Detonations are simulated with hydrogen and oxygen, and cellular structures are computed in two and three dimensions. Grid resolutions achieved were finer than previously published results at the time. 

Henshaw and Schwendeman developed a method \cite{henshaw} for simulating reacting flow inside complex geometries using a block-structured adaptive mesh refinement and overlapping grids . The reactive Euler equations were modeled along with stiff reaction models and an ideal equation of state. The focus was extending the typical AMR techniques of the time to overset grid methods in a curvilinear domain. The detonation examined was in an expanding channel, and the reaction chemistry was single-step with Arrhenius rate reaction modeling. 

Yi \textit{et al.} \cite{yi} explored three-dimensional numerical simulations of rotating detonations in an annular chamber in 2009. Overall flow field structure is studied under continuous fuel injection into the combustion chamber. The code used for simulation was developed by the authors and modeled the reactive Euler equations discretized with the finite volume menthod (FVM). The governing equations utilized a MUSCL-based scheme \cite{vanleer} and temporal terms discretized with second-order techniques. The flow field was also examined in two dimensions, and overall reaction modeling was single-step. Previous one- and two-dimensional RDE models were compared to three-dimensional results. 

Kessler \textit{et al.} \cite{kessler} discuss cell structures in methane-air mixture detonations. High-resolution numerical simulations showed multi-level cellular detonation structures. Transverse waves trailing the detonation wavefront created the structure for several configurations of detonation cells. These cells were qualitatively matched with experimental smoke foil results. 

Together, these papers and other similar work have laid the framework for adaptive meshing of detonation modeling in OpenFOAM. 



\section{Thesis Organization}
This document is broken up into several chapters. The next chapter discusses the fundamental governing equations of the flows studied here. It introduces various numerical solution techniques, as well as how they are implemented in order to approximate a solution to the governing equations. This chapter also discusses OpenFOAM as a whole, as well as specific details as to how detonations were modeled with the toolbox. Some initial failures are shown here and solutions or alternatives used to overcome the failures. The following chapter compares different solver parameters used to model detonations and how the variation of the parameters affects the solution. Different levels of accuracy are discussed as well as well as generic results and comparisons overall. Conclusions and directions for future work are provided at the end.